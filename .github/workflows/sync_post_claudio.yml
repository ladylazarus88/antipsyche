name: âš¡ Simple posts sync

on: workflow_dispatch  # Solo manuale per test

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: â¬‡ï¸ Copy posts folder
        run: |
          # Clona SOLO la cartella posts
          git clone \
            --depth=1 \
            --no-checkout \
            https://github.com/ladylazarus88/antipsyche-post.git \
            temp_repo
          
          cd temp_repo
          git sparse-checkout init --cone
          git sparse-checkout set _posts
          git checkout
          
          # Copia se esiste
          if [ -d "posts" ]; then
            mkdir -p ../posts
            cp posts/*.md ../posts/ 2>/dev/null || true
            echo "âœ… Copiati $(ls ../posts/*.md 2>/dev/null | wc -l) file"
          fi
          
          cd ..
          rm -rf temp_repo
      
      - name: ðŸ’¾ Save changes
        run: |
          git add posts/
          git diff --cached --quiet || (git commit -m "Add posts" && git push)